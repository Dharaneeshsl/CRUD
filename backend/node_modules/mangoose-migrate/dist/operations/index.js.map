{"version":3,"sources":["../../src/operations/create-model.ts","../../src/operations/add-field.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Connection } from 'mongoose';\nimport { MigrationOperation } from '../types.js';\nimport mongoose from 'mongoose';\n\nexport class CreateModel implements MigrationOperation {\n  constructor(\n    private readonly modelName: string,\n    private readonly schemaDefinition: Record<string, any>,\n  ) {}\n\n  async applyUp(connection: Connection): Promise<void> {\n    const schema = new mongoose.Schema(this.schemaDefinition);\n    connection.model(this.modelName, schema);\n  }\n\n  async applyDown(connection: Connection): Promise<void> {\n    connection.deleteModel(this.modelName);\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Connection } from 'mongoose';\nimport { MigrationOperation } from '../types.js';\n\nexport class AddField implements MigrationOperation {\n  constructor(\n    private readonly modelName: string,\n    private readonly fieldName: string,\n    private readonly fieldDefinition: any,\n  ) {}\n\n  async applyUp(connection: Connection): Promise<void> {\n    const model = connection.model(this.modelName);\n    const schema = model.schema;\n\n    schema.add({ [this.fieldName]: this.fieldDefinition });\n    // re-compile connection model\n    connection.model(this.modelName, schema);\n  }\n\n  async applyDown(connection: Connection): Promise<void> {\n    const model = connection.model(this.modelName);\n    const schema = model.schema;\n\n    schema.remove(this.fieldName);\n    // re-compile connection model\n    connection.model(this.modelName, schema);\n  }\n}\n"],"mappings":";AAGA,OAAO,cAAc;AAEd,IAAM,cAAN,MAAgD;AAAA,EACrD,YACmB,WACA,kBACjB;AAFiB;AACA;AAAA,EAChB;AAAA,EAEH,MAAM,QAAQ,YAAuC;AACnD,UAAM,SAAS,IAAI,SAAS,OAAO,KAAK,gBAAgB;AACxD,eAAW,MAAM,KAAK,WAAW,MAAM;AAAA,EACzC;AAAA,EAEA,MAAM,UAAU,YAAuC;AACrD,eAAW,YAAY,KAAK,SAAS;AAAA,EACvC;AACF;;;ACfO,IAAM,WAAN,MAA6C;AAAA,EAClD,YACmB,WACA,WACA,iBACjB;AAHiB;AACA;AACA;AAAA,EAChB;AAAA,EAEH,MAAM,QAAQ,YAAuC;AACnD,UAAM,QAAQ,WAAW,MAAM,KAAK,SAAS;AAC7C,UAAM,SAAS,MAAM;AAErB,WAAO,IAAI,EAAE,CAAC,KAAK,SAAS,GAAG,KAAK,gBAAgB,CAAC;AAErD,eAAW,MAAM,KAAK,WAAW,MAAM;AAAA,EACzC;AAAA,EAEA,MAAM,UAAU,YAAuC;AACrD,UAAM,QAAQ,WAAW,MAAM,KAAK,SAAS;AAC7C,UAAM,SAAS,MAAM;AAErB,WAAO,OAAO,KAAK,SAAS;AAE5B,eAAW,MAAM,KAAK,WAAW,MAAM;AAAA,EACzC;AACF;","names":[]}